<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#2c3e50">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>TruckInvoice - Quick Invoice Generator for OTR Drivers</title>
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/png" sizes="192x192" href="icon-192.png">
    <link rel="apple-touch-icon" href="icon-192.png">
</head>
<body>
    <div class="container">
        <h1>TruckInvoice Generator</h1>
        <p class="subtitle">Generate professional invoices in seconds</p>

        <!-- Navigation Tabs -->
        <div class="nav-tabs">
            <button type="button" id="newInvoiceBtn" class="nav-tab active">New Invoice</button>
            <button type="button" id="historyBtn" class="nav-tab">Invoice History</button>
            <button type="button" id="expensesBtn" class="nav-tab">Expenses</button>
            <button type="button" id="dashboardBtn" class="nav-tab">Dashboard</button>
        </div>

        <!-- New Invoice View -->
        <div id="invoiceFormView" class="view active">
        <form id="invoiceForm">
            <!-- Your Company Info (saved automatically) -->
            <div class="section">
                <h2>Your Company Info (Auto-saved)</h2>
                <div class="form-group">
                    <label>Your Company Name:</label>
                    <input type="text" id="companyName" placeholder="ABC Transportation LLC" required>
                </div>
                <div class="form-group">
                    <label>Your Address:</label>
                    <input type="text" id="companyAddress" placeholder="123 Main St, Your City, ST 12345" required>
                </div>
                <div class="form-group">
                    <label>Carrier ID:</label>
                    <input type="text" id="carrierId" placeholder="000000" required>
                </div>
                <div class="form-group">
                    <label>Your Email (for notifications):</label>
                    <input type="email" id="userEmail" placeholder="driver@example.com" required>
                </div>
            </div>

            <!-- Load Details (changes each time) -->
            <div class="section">
                <h2>Load Details</h2>
                <div class="form-row">
                    <div class="form-group">
                        <label>Invoice #:</label>
                        <input type="text" id="invoiceNumber" placeholder="001" required>
                    </div>
                    <div class="form-group">
                        <label>Invoice Date:</label>
                        <input type="date" id="invoiceDate" required>
                    </div>
                </div>

                <div class="form-group">
                    <label>Customer's Name:</label>
                    <div class="customer-input-wrapper">
                        <input type="text" id="customerName" placeholder="ABC Company LLC" required>
                        <select id="customerQuickFill" class="quick-fill-select" title="Select a repeat customer to auto-fill details">
                            <option value="">Quick Fill...</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Date Delivered:</label>
                        <input type="date" id="dateDelivered" required>
                    </div>
                    <div class="form-group">
                        <label>Load Number:</label>
                        <input type="text" id="loadNumber" placeholder="LOAD123" required>
                    </div>
                </div>

                <div class="form-group">
                    <label>Amount to be Paid ($):</label>
                    <input type="number" step="0.01" id="amount" placeholder="1000.00" required>
                </div>
            </div>

            <!-- Mile/Rate Calculator -->
            <div class="section calculator-section">
                <h2>Mile/Rate Calculator (Optional)</h2>
                <div class="form-row">
                    <div class="form-group">
                        <label>Miles Driven:</label>
                        <input type="number" step="0.1" id="miles" placeholder="450">
                    </div>
                    <div class="form-group">
                        <label>Rate per Mile ($):</label>
                        <input type="number" step="0.01" id="ratePerMile" placeholder="2.50">
                    </div>
                </div>
                <div class="calculator-result">
                    <div class="calculated-amount" id="calculatedAmount">
                        <span class="calc-label">Calculated Amount:</span>
                        <span class="calc-value">$0.00</span>
                    </div>
                    <button type="button" class="btn-use-calculated" id="useCalculated" disabled>Use This Amount</button>
                </div>
            </div>

            <button type="submit" class="btn-generate">Generate Invoice PDF</button>
        </form>
        </div>

        <!-- Invoice History View -->
        <div id="historyView" class="view">
            <div class="history-header-section">
                <input type="text" id="searchHistory" placeholder="Search by invoice #, load #, or customer name..." class="search-input">
            </div>
            <div id="historyList" class="history-list">
                <div class="no-history">No invoices yet. Generate your first invoice!</div>
            </div>
        </div>

        <!-- Expenses View -->
        <div id="expensesView" class="view">
            <form id="expenseForm" class="expense-form">
                <div class="section">
                    <h2>Add Expense</h2>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Date:</label>
                            <input type="date" id="expenseDate" required>
                        </div>
                        <div class="form-group">
                            <label>Amount ($):</label>
                            <input type="number" step="0.01" id="expenseAmount" placeholder="50.00" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Category:</label>
                            <select id="expenseCategory" title="Select expense category" required>
                                <option value="">Select Category...</option>
                                <option value="fuel">Fuel</option>
                                <option value="maintenance">Maintenance & Repairs</option>
                                <option value="tolls">Tolls & Parking</option>
                                <option value="food">Food & Meals</option>
                                <option value="insurance">Insurance</option>
                                <option value="permits">Permits & Licenses</option>
                                <option value="truck_payment">Truck Payment/Lease</option>
                                <option value="supplies">Supplies</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Vendor/Location:</label>
                            <input type="text" id="expenseVendor" placeholder="Pilot Flying J" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Notes (Optional):</label>
                        <input type="text" id="expenseNotes" placeholder="Additional details...">
                    </div>
                    <button type="submit" class="btn-generate">Add Expense</button>
                </div>
            </form>

            <div class="expense-history-section">
                <div class="history-header-section">
                    <input type="text" id="searchExpenses" placeholder="Search expenses..." class="search-input">
                </div>
                <div id="expensesList" class="history-list">
                    <div class="no-history">No expenses yet. Add your first expense!</div>
                </div>
            </div>
        </div>

        <!-- Dashboard View -->
        <div id="dashboardView" class="view">
            <div class="dashboard-header">
                <h2>Financial Dashboard</h2>
                <div class="year-selector">
                    <label>Year:</label>
                    <select id="dashboardYear" title="Select year for dashboard">
                        <!-- Populated by JavaScript -->
                    </select>
                </div>
            </div>

            <div class="dashboard-cards">
                <div class="dashboard-card income-card">
                    <div class="card-icon">ðŸ“Š</div>
                    <div class="card-content">
                        <div class="card-label">Total Income (YTD)</div>
                        <div class="card-value" id="ytdIncome">$0.00</div>
                    </div>
                </div>
                <div class="dashboard-card expense-card">
                    <div class="card-icon">ðŸ’°</div>
                    <div class="card-content">
                        <div class="card-label">Total Expenses (YTD)</div>
                        <div class="card-value" id="ytdExpenses">$0.00</div>
                    </div>
                </div>
                <div class="dashboard-card profit-card">
                    <div class="card-icon">ðŸ“ˆ</div>
                    <div class="card-content">
                        <div class="card-label">Net Profit (YTD)</div>
                        <div class="card-value" id="ytdProfit">$0.00</div>
                    </div>
                </div>
            </div>

            <div class="dashboard-breakdown">
                <div class="section">
                    <h3>Expense Breakdown</h3>
                    <div id="expenseBreakdown" class="breakdown-list">
                        <!-- Populated by JavaScript -->
                    </div>
                </div>
                <div class="section">
                    <h3>Monthly Summary</h3>
                    <div id="monthlySummary" class="monthly-summary">
                        <!-- Populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
    <script src="script.js"></script>
</body>
</html>
